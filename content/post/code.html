---
author: 
  - 赵鹏
title: '作图代码'
slug: code
weight: 80
toc-title: "目录"
description: 图的绘制代码和说明如表所示。运行表中的代码，即可再现书中的插图。
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="最直观的方法" class="section level2">
<h2>最直观的方法</h2>
<p>本书插图除了外部引用的图片外，均使用 R 语言绘制。读者可以很方便地获取作图代码，来重现书中插图，方法如下：</p>
<pre class="r"><code>install.packages(&quot;MSG&quot;) # 初次使用时安装 MSG 包
library(&quot;MSG&quot;) # 加载包
msg(&#39;4.1&#39;) # 重现插图 4.1 和获取作图代码</code></pre>
<p>这是最直观的方式，即运行 <code>msg('图的编号')</code>。注意：图的编号要放在一对引号里，它是个字符串。如果忘记了输入引号，那么得到的源代码和图形可能不是你想要得到的，如 <code>msg(4.10)</code> 将得到图 4.1 而非图 4.10。</p>
</div>
<div id="可能遇到的问题" class="section level2">
<h2>可能遇到的问题</h2>
<div id="附加包支持" class="section level3">
<h3>附加包支持</h3>
<p>有些图形需要额外的附加包支持，初次使用时需要读者自行安装。</p>
<p>如果觉得逐个安装太麻烦，读者可以运行：</p>
<pre class="r"><code>msg(&#39;0&#39;)</code></pre>
<p>就可一次性安装本书示例代码中所需的全部附加包。</p>
</div>
<div id="中文支持" class="section level3">
<h3>中文支持</h3>
<p>如果读者用的是 Windows 操作系统，而区域语言的设置不是中文（这种情况在本书的读者群里应该很少见），则可能在重现图形时遇到如下警告：</p>
<pre><code>Warning message:
In readLines(file, warn = FALSE) :
  invalid input found on input connection &#39;......&#39; </code></pre>
<p>这种情况下，只需在作图前需运行下面一行来支持中文字符：</p>
<pre class="r"><code>Sys.setlocale(&quot;LC_CTYPE&quot;, &quot;Chinese&quot;)</code></pre>
</div>
</div>
<div id="基础作图与-ggplot2" class="section level2">
<h2>基础作图与 <strong>ggplot2</strong></h2>
<p>很多图形我们都给出了 R 基础作图和 <strong>ggplot2</strong> 作图两种解决方案，在这种情况下，<code>msg('图的编号')</code>得到的一般是基础作图代码和图形。如果想得到 <strong>ggplot2</strong> 图形，只需在图形编号前面增加一个 <code>2</code> 就可以了，例如：</p>
<pre class="r"><code>msg(&#39;24.1&#39;)</code></pre>
<p>就可得到图 4.1 的 <strong>ggplot2</strong> 版本，包括图示和源代码。</p>
<p>注意，并非所有的图都有两个版本；支持编号前有 <code>2</code>的图见附表。</p>
<p>有些图形还可以在编号前面增加个 <code>3</code>。至于用处是什么，你猜。</p>
</div>
<div id="图的英文代号" class="section level2">
<h2>图的英文代号</h2>
<p>除了 <code>msg('图的编号')</code> 外，也可以运行 <code>msg('图的英文代号')</code>。例如，图 4.1 的英文代号是 “vadeaths-barplot”，那么可运行 <code>msg('vadeaths-barplot')</code>，等价于 <code>msg('4.1')</code>。</p>
<p>图的编号和英文代号如附表所示。</p>

<table>
<caption>表 1. <code>MSG::msg()</code> 函数支持的图编号和英文代码</caption>
<thead>
<tr class="header">
<th align="right">编号</th>
<th align="left">英文代号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">install-packages</td>
</tr>
<tr class="even">
<td align="right">2.2</td>
<td align="left">ggplot2-minard</td>
</tr>
<tr class="odd">
<td align="right">3.2</td>
<td align="left">pork-price</td>
</tr>
<tr class="even">
<td align="right">23.2</td>
<td align="left">pork-price2</td>
</tr>
<tr class="odd">
<td align="right">3.4</td>
<td align="left">canabalt-boxplot</td>
</tr>
<tr class="even">
<td align="right">3.7</td>
<td align="left">tvearn</td>
</tr>
<tr class="odd">
<td align="right">3.8</td>
<td align="left">music-andrews</td>
</tr>
<tr class="even">
<td align="right">33.14</td>
<td align="left">music-andrews-tikz</td>
</tr>
<tr class="odd">
<td align="right">3.9</td>
<td align="left">music-3d-pcp</td>
</tr>
<tr class="even">
<td align="right">3.10</td>
<td align="left">assists-sna</td>
</tr>
<tr class="odd">
<td align="right">3.11</td>
<td align="left">basketball</td>
</tr>
<tr class="even">
<td align="right">3.12</td>
<td align="left">basketball-fourfold</td>
</tr>
<tr class="odd">
<td align="right">3.13</td>
<td align="left">gov-cn-pct</td>
</tr>
<tr class="even">
<td align="right">23.19</td>
<td align="left">gov-cn-pct2</td>
</tr>
<tr class="odd">
<td align="right">3.14</td>
<td align="left">PlantCounts</td>
</tr>
<tr class="even">
<td align="right">23.14</td>
<td align="left">PlantCounts2</td>
</tr>
<tr class="odd">
<td align="right">3.15</td>
<td align="left">song-words-hclust</td>
</tr>
<tr class="even">
<td align="right">3.16</td>
<td align="left">song-words-corr</td>
</tr>
<tr class="odd">
<td align="right">3.17</td>
<td align="left">song-high-freq</td>
</tr>
<tr class="even">
<td align="right">3.18</td>
<td align="left">multireg-scatter</td>
</tr>
<tr class="odd">
<td align="right">23.18</td>
<td align="left">multireg-scatter2</td>
</tr>
<tr class="even">
<td align="right">33.18</td>
<td align="left">multireg-scatter2-tikz</td>
</tr>
<tr class="odd">
<td align="right">3.19</td>
<td align="left">interaction-bubble</td>
</tr>
<tr class="even">
<td align="right">33.19</td>
<td align="left">interaction-bubble-tikz</td>
</tr>
<tr class="odd">
<td align="right">3.20</td>
<td align="left">OLS-LMS</td>
</tr>
<tr class="even">
<td align="right">23.20</td>
<td align="left">OLS-LMS2</td>
</tr>
<tr class="odd">
<td align="right">33.20</td>
<td align="left">OLS-LMS2-tikz</td>
</tr>
<tr class="even">
<td align="right">3.21</td>
<td align="left">outlier-resample</td>
</tr>
<tr class="odd">
<td align="right">23.21</td>
<td align="left">outlier-resample2</td>
</tr>
<tr class="even">
<td align="right">33.21</td>
<td align="left">outlier-resample2-tikz</td>
</tr>
<tr class="odd">
<td align="right">4.1</td>
<td align="left">vadeaths-barplot</td>
</tr>
<tr class="even">
<td align="right">24.1</td>
<td align="left">vadeaths-barplot2</td>
</tr>
<tr class="odd">
<td align="right">4.2</td>
<td align="left">dotchart</td>
</tr>
<tr class="even">
<td align="right">4.3</td>
<td align="left">dotchart2</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="left">hist-geyser</td>
</tr>
<tr class="even">
<td align="right">24.4</td>
<td align="left">hist-geyser2</td>
</tr>
<tr class="odd">
<td align="right">4.5</td>
<td align="left">hist-density</td>
</tr>
<tr class="even">
<td align="right">24.5</td>
<td align="left">hist-density2</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="left">stem-islands</td>
</tr>
<tr class="even">
<td align="right">4.7</td>
<td align="left">stem-poisson</td>
</tr>
<tr class="odd">
<td align="right">4.8</td>
<td align="left">insects-boxplot</td>
</tr>
<tr class="even">
<td align="right">24.8</td>
<td align="left">insects-boxplot2</td>
</tr>
<tr class="odd">
<td align="right">4.9</td>
<td align="left">rnorm-boxplot</td>
</tr>
<tr class="even">
<td align="right">24.9</td>
<td align="left">rnorm-boxplot2</td>
</tr>
<tr class="odd">
<td align="right">34.9</td>
<td align="left">rnorm-boxplot2-tikz</td>
</tr>
<tr class="even">
<td align="right">4.10</td>
<td align="left">vioplot</td>
</tr>
<tr class="odd">
<td align="right">24.10</td>
<td align="left">vioplot2</td>
</tr>
<tr class="even">
<td align="right">4.11</td>
<td align="left">rug</td>
</tr>
<tr class="odd">
<td align="right">24.11</td>
<td align="left">rug2</td>
</tr>
<tr class="even">
<td align="right">4.12</td>
<td align="left">stripchart</td>
</tr>
<tr class="odd">
<td align="right">4.13</td>
<td align="left">stripchart2</td>
</tr>
<tr class="even">
<td align="right">4.14</td>
<td align="left">pie-chart</td>
</tr>
<tr class="odd">
<td align="right">24.14</td>
<td align="left">pie-chart2</td>
</tr>
<tr class="even">
<td align="right">4.15</td>
<td align="left">floating-pie</td>
</tr>
<tr class="odd">
<td align="right">4.16</td>
<td align="left">qqnorm</td>
</tr>
<tr class="even">
<td align="right">24.16</td>
<td align="left">qqnorm2</td>
</tr>
<tr class="odd">
<td align="right">4.17</td>
<td align="left">nightingale-ggplot2</td>
</tr>
<tr class="even">
<td align="right">5.1</td>
<td align="left">scatter-alpha</td>
</tr>
<tr class="odd">
<td align="right">25.1</td>
<td align="left">scatter-alpha2</td>
</tr>
<tr class="even">
<td align="right">5.2</td>
<td align="left">curve</td>
</tr>
<tr class="odd">
<td align="right">25.2</td>
<td align="left">curve2</td>
</tr>
<tr class="even">
<td align="right">35.2</td>
<td align="left">curve-tikz</td>
</tr>
<tr class="odd">
<td align="right">5.3</td>
<td align="left">sunflowerplot</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="left">smoothScatter</td>
</tr>
<tr class="odd">
<td align="right">25.4</td>
<td align="left">smoothScatter2</td>
</tr>
<tr class="even">
<td align="right">5.5</td>
<td align="left">windrose</td>
</tr>
<tr class="odd">
<td align="right">5.6</td>
<td align="left">survival</td>
</tr>
<tr class="even">
<td align="right">25.6</td>
<td align="left">survival2</td>
</tr>
<tr class="odd">
<td align="right">5.7</td>
<td align="left">cdplot</td>
</tr>
<tr class="even">
<td align="right">25.7</td>
<td align="left">cdplot2</td>
</tr>
<tr class="odd">
<td align="right">5.8</td>
<td align="left">spineplot</td>
</tr>
<tr class="even">
<td align="right">5.9</td>
<td align="left">bagplot</td>
</tr>
<tr class="odd">
<td align="right">25.9</td>
<td align="left">bagplot2</td>
</tr>
<tr class="even">
<td align="right">6.1</td>
<td align="left">pairs</td>
</tr>
<tr class="odd">
<td align="right">6.2</td>
<td align="left">pairs2</td>
</tr>
<tr class="even">
<td align="right">6.3</td>
<td align="left">coplot</td>
</tr>
<tr class="odd">
<td align="right">6.4</td>
<td align="left">ChinaPop</td>
</tr>
<tr class="even">
<td align="right">6.5</td>
<td align="left">symbols_all</td>
</tr>
<tr class="odd">
<td align="right">6.6</td>
<td align="left">stars</td>
</tr>
<tr class="even">
<td align="right">6.7</td>
<td align="left">faces2</td>
</tr>
<tr class="odd">
<td align="right">6.8</td>
<td align="left">murcia-ternary</td>
</tr>
<tr class="even">
<td align="right">6.9</td>
<td align="left">mosaicplot</td>
</tr>
<tr class="odd">
<td align="right">6.10</td>
<td align="left">plot-design</td>
</tr>
<tr class="even">
<td align="right">6.11</td>
<td align="left">interaction-plot</td>
</tr>
<tr class="odd">
<td align="right">6.12</td>
<td align="left">rpart</td>
</tr>
<tr class="even">
<td align="right">6.13</td>
<td align="left">ggparcoord</td>
</tr>
<tr class="odd">
<td align="right">6.14</td>
<td align="left">andrews-curve</td>
</tr>
<tr class="even">
<td align="right">36.14</td>
<td align="left">andrews-curve-tikz</td>
</tr>
<tr class="odd">
<td align="right">7.1</td>
<td align="left">contour-grid</td>
</tr>
<tr class="even">
<td align="right">27.1</td>
<td align="left">contour-grid2</td>
</tr>
<tr class="odd">
<td align="right">37.1</td>
<td align="left">contour-grid2-tikz</td>
</tr>
<tr class="even">
<td align="right">7.2</td>
<td align="left">contour-pop</td>
</tr>
<tr class="odd">
<td align="right">27.2</td>
<td align="left">contour-pop2</td>
</tr>
<tr class="even">
<td align="right">7.3</td>
<td align="left">density-2d-filled</td>
</tr>
<tr class="odd">
<td align="right">7.4</td>
<td align="left">filled-contour</td>
</tr>
<tr class="even">
<td align="right">7.5</td>
<td align="left">image24</td>
</tr>
<tr class="odd">
<td align="right">27.5</td>
<td align="left">image242</td>
</tr>
<tr class="even">
<td align="right">37.5</td>
<td align="left">image242-tikz</td>
</tr>
<tr class="odd">
<td align="right">7.6</td>
<td align="left">image</td>
</tr>
<tr class="even">
<td align="right">27.6</td>
<td align="left">image2</td>
</tr>
<tr class="odd">
<td align="right">7.7</td>
<td align="left">persp</td>
</tr>
<tr class="even">
<td align="right">7.8</td>
<td align="left">persp-pop</td>
</tr>
<tr class="odd">
<td align="right">37.8</td>
<td align="left">persp-pop-tikz</td>
</tr>
<tr class="even">
<td align="right">7.9</td>
<td align="left">matplot</td>
</tr>
<tr class="odd">
<td align="right">7.10</td>
<td align="left">matplot2</td>
</tr>
<tr class="even">
<td align="right">37.10</td>
<td align="left">matplot2-tikz</td>
</tr>
<tr class="odd">
<td align="right">7.11</td>
<td align="left">heatmap</td>
</tr>
<tr class="even">
<td align="right">7.12</td>
<td align="left">assocplot</td>
</tr>
<tr class="odd">
<td align="right">7.13</td>
<td align="left">fourfoldplot</td>
</tr>
<tr class="even">
<td align="right">7.14</td>
<td align="left">fig-contour-persp</td>
</tr>
<tr class="odd">
<td align="right">7.15</td>
<td align="left">assocplot2</td>
</tr>
<tr class="even">
<td align="right">8.1</td>
<td align="left">discrete-var</td>
</tr>
<tr class="odd">
<td align="right">8.2</td>
<td align="left">pay-rating-points</td>
</tr>
<tr class="even">
<td align="right">38.2</td>
<td align="left">pay-rating-points-tikz</td>
</tr>
<tr class="odd">
<td align="right">8.3</td>
<td align="left">pay-rating-log</td>
</tr>
<tr class="even">
<td align="right">8.4</td>
<td align="left">music-mds</td>
</tr>
<tr class="odd">
<td align="right">8.5</td>
<td align="left">tufte1997</td>
</tr>
<tr class="even">
<td align="right">8.6</td>
<td align="left">cut-plot</td>
</tr>
<tr class="odd">
<td align="right">38.6</td>
<td align="left">cut-plot-tikz</td>
</tr>
<tr class="even">
<td align="right">8.8</td>
<td align="left">sunspots-asp</td>
</tr>
<tr class="odd">
<td align="right">8.9</td>
<td align="left">optical-illusion</td>
</tr>
<tr class="even">
<td align="right">8.10</td>
<td align="left">kmeans-cluster</td>
</tr>
<tr class="odd">
<td align="right">38.10</td>
<td align="left">kmeans-cluster-tikz</td>
</tr>
<tr class="even">
<td align="right">8.11</td>
<td align="left">error-bars</td>
</tr>
<tr class="odd">
<td align="right">9.1</td>
<td align="left">lines-demo</td>
</tr>
<tr class="even">
<td align="right">9.2</td>
<td align="left">graphicsEvent</td>
</tr>
<tr class="odd">
<td align="right">9.3</td>
<td align="left">par2</td>
</tr>
<tr class="even">
<td align="right">9.4</td>
<td align="left">plot-region</td>
</tr>
<tr class="odd">
<td align="right">9.5</td>
<td align="left">ColorBrewer-all</td>
</tr>
<tr class="even">
<td align="right">9.6</td>
<td align="left">grad-color</td>
</tr>
<tr class="odd">
<td align="right">9.7</td>
<td align="left">point-type</td>
</tr>
<tr class="even">
<td align="right">9.8</td>
<td align="left">point-iris</td>
</tr>
<tr class="odd">
<td align="right">9.9</td>
<td align="left">point-random</td>
</tr>
<tr class="even">
<td align="right">9.10</td>
<td align="left">plot-type</td>
</tr>
<tr class="odd">
<td align="right">9.11</td>
<td align="left">xspline-demo</td>
</tr>
<tr class="even">
<td align="right">9.12</td>
<td align="left">polygon-kaleidoscope</td>
</tr>
<tr class="odd">
<td align="right">9.13</td>
<td align="left">polygon-demo</td>
</tr>
<tr class="even">
<td align="right">9.14</td>
<td align="left">text</td>
</tr>
<tr class="odd">
<td align="right">9.15</td>
<td align="left">axis-demo</td>
</tr>
<tr class="even">
<td align="right">9.16</td>
<td align="left">plotmath</td>
</tr>
<tr class="odd">
<td align="right">39.16</td>
<td align="left">plotmath-tikz</td>
</tr>
<tr class="even">
<td align="right">9.17</td>
<td align="left">layout</td>
</tr>
<tr class="odd">
<td align="right">9.18</td>
<td align="left">layout-margin</td>
</tr>
<tr class="even">
<td align="right">9.19</td>
<td align="left">split-screen</td>
</tr>
<tr class="odd">
<td align="right">9.20</td>
<td align="left">par1</td>
</tr>
<tr class="even">
<td align="right">9.21</td>
<td align="left">waterfall-chart</td>
</tr>
<tr class="odd">
<td align="right">9.22</td>
<td align="left">gradArrows</td>
</tr>
<tr class="even">
<td align="right">9.23</td>
<td align="left">sign-stat</td>
</tr>
<tr class="odd">
<td align="right">10.1</td>
<td align="left">qplot</td>
</tr>
<tr class="even">
<td align="right">10.2</td>
<td align="left">mtcars-smooth</td>
</tr>
<tr class="odd">
<td align="right">10.3</td>
<td align="left">diamonds-hex</td>
</tr>
<tr class="even">
<td align="right">10.4</td>
<td align="left">ggplot2-violin</td>
</tr>
<tr class="odd">
<td align="right">10.5</td>
<td align="left">iris-ggplot2</td>
</tr>
<tr class="even">
<td align="right">10.6</td>
<td align="left">quake6-bubbles</td>
</tr>
<tr class="odd">
<td align="right">310.6</td>
<td align="left">quake6-bubbles-tikz</td>
</tr>
<tr class="even">
<td align="right">10.7</td>
<td align="left">diamonds-cut</td>
</tr>
<tr class="odd">
<td align="right">10.8</td>
<td align="left">diamonds-polar</td>
</tr>
<tr class="even">
<td align="right">10.9</td>
<td align="left">diamonds-carat</td>
</tr>
<tr class="odd">
<td align="right">10.10</td>
<td align="left">geom-jitter-demo</td>
</tr>
<tr class="even">
<td align="right">10.11</td>
<td align="left">ggplot2-theme</td>
</tr>
<tr class="odd">
<td align="right">10.12</td>
<td align="left">ggplot2-layers</td>
</tr>
<tr class="even">
<td align="right">11.1</td>
<td align="left">grid-subplot</td>
</tr>
<tr class="odd">
<td align="right">311.1</td>
<td align="left">grid-subplot-tikz</td>
</tr>
<tr class="even">
<td align="right">11.2</td>
<td align="left">grid-rotate</td>
</tr>
<tr class="odd">
<td align="right">11.3</td>
<td align="left">grid-princomp</td>
</tr>
<tr class="even">
<td align="right">11.4</td>
<td align="left">lattice-iris-hist</td>
</tr>
<tr class="odd">
<td align="right">11.5</td>
<td align="left">lattice-vadeaths</td>
</tr>
<tr class="even">
<td align="right">11.6</td>
<td align="left">lattice-data-par</td>
</tr>
<tr class="odd">
<td align="right">311.6</td>
<td align="left">lattice-data-par-tikz</td>
</tr>
<tr class="even">
<td align="right">11.7</td>
<td align="left">lattice-panel-function</td>
</tr>
<tr class="odd">
<td align="right">11.8</td>
<td align="left">rgl-ch4</td>
</tr>
<tr class="even">
<td align="right">11.9</td>
<td align="left">rgl-beta</td>
</tr>
<tr class="odd">
<td align="right">11.11</td>
<td align="left">animation-pollen</td>
</tr>
</tbody>
</table>
</div>
